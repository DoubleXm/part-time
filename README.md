## part-time

åŸºäº Koa ç›¸å…³æŠ€æœ¯æ ˆçš„ å…¼èŒå¹³å°(å‰åç«¯)æ¥å£

## é¡¹ç›®èƒŒæ™¯

å‰æ®µæ—¶é—´å†™äº†ä¸€ç¯‡å…³äº `koa` çš„å„ç§ä¸­é—´ä»¶çš„åº”ç”¨æ–‡ç«  [ä¼ é€é—¨](https://juejin.cn/post/6914163421208412173) æƒ³ç€å…·ä½“åº”ç”¨ä¸€ä¸‹, è‡ªå·±èƒ½å¤Ÿåšä¸ªå°çš„é¡¹ç›®, ä¹Ÿç®—æ˜¯é”»ç‚¼ä¸€ä¸‹è‡ªå·±çš„åŠ¨æ‰‹èƒ½åŠ›, å¦ä¸€æ–¹é¢ä¹Ÿå¸Œæœ›å¯¹äºå¤§å®¶æœ‰äº›è®¸å¸®åŠ©, å½“ç„¶ä¸æ»¡æ„è¿˜è¯·è½»è½»çš„å–·ğŸ˜‚ï¼Œç°åœ¨å·²ç»åŸºæœ¬å®Œæˆäº†å°±åˆ†äº«ç»™å¤§å®¶ ; 

é¡¹ç›®çš„æ•´ä½“ä½¿ç”¨æŠ€æœ¯æ˜¯å›´ç»• `koa` å’Œ `mysql` è¿›è¡Œçš„ ; å…¶ä¸­åŠ å…¥äº†ä¸€äº›å…¶ä»–çš„å‘¨è¾¹åº“ ; æ¯”å¦‚ `mysql` çš„ `ORM` `sequelize` ; `koa` çš„ `body` è§£æä¸­é—´ä»¶ `koa-body` ç­‰ç­‰ .... ç›®å‰é¡¹ç›®å·²ç»æ”¾åˆ° `github` äº†  [ä¼ é€é—¨](https://github.com/ShuQingX/part-time) 

## é¡¹ç›®å®‰è£…

æœ¬é¡¹ç›®ä¾èµ–äº `mysql` æ‰€ä»¥éœ€è¦æå‰å®‰è£… ; å¯¹äºå®‰è£… win ç³»ç»Ÿæ¨èå¤§å®¶çœ‹ä¸€ä¸‹è¿™ç¯‡æ–‡ç« , å¸Œæœ›å¯¹ä½ æœ‰å¸®åŠ© [ä¼ é€é—¨](https://www.runoob.com/w3cnote/windows10-mysql-installer.html) å¯¹äº mac å®åœ¨ä¸å¥½æ„æ€, è‡ªå·±æƒ³æƒ³åŠæ³•å§ ; 

å…³äº `mysql` çš„ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µ , å¼ºçƒˆæ¨èä¸æ˜¯å¾ˆäº†è§£è¿æ¥æ± çš„åŒå­¦å¯ä»¥çœ‹ä¸€çœ‹ [ä¼ é€é—¨](https://juejin.cn/post/6844903850630086669) ; 

`ORM` ä¹Ÿä¸€å¹¶æä¸€ä¸‹å§ , `Object-relational mapping` æ–‡æ¡£å¯¹è±¡æ¨¡å‹ , ä¸€å¥è¯æ¦‚æ‹¬ (å¯èƒ½ä¼šæœ‰è¯¯å·®) å°±æ˜¯ä¸å†™ `sql` æ“ä½œæ•°æ®åº“ , æŠŠè¡¨å½“åšå¯¹è±¡æ¥ç»´æŠ¤ ; æœ¬é¡¹ç›®ä¸­ä½¿ç”¨çš„ `sequelize` ORM æ¡†æ¶ [ä¼ é€é—¨](https://www.sequelize.com.cn/)

åœ¨å®‰è£…å¹¶äº†è§£ä»¥ä¸Šæ¦‚å¿µä¹‹å, clone é¡¹ç›®å¹¶ä¸”ä¿®æ”¹ `part-time/config/index.js` ä¸‹çš„æ•°æ®åº“é…ç½® ; éšåæ‰§è¡Œ `npm install` å®‰è£…ç›¸å…³çš„ä¾èµ– ; 

#### é¡¹ç›®å¯åŠ¨ :  

```bash
npm run dev # æµ‹è¯•ç¯å¢ƒ
```

```bash
npm run prd # ç”Ÿäº§ç¯å¢ƒ
```

#### æ–‡æ¡£æŸ¥çœ‹

é¡¹ç›®çš„æœ€åˆæˆ‘è¿˜æƒ³ç€è¦ä¸è¦å¼„ swagger , æ— å¥ˆåˆæ˜¯æ‡’, åœ¨é¡¹ç›®çš„ `config` ä¸‹æœ‰ä¸ª `part-time.json` æ˜¯ä½œè€…è°ƒè¯•æ¥å£çš„æ—¶å€™å­˜ä¸‹æ¥çš„, å¤§å®¶å¯ä»¥ä½¿ç”¨ `postman` æ¥å£è°ƒè¯•å·¥å…·å¯¼å…¥è¿™ä¸ªæ–‡ä»¶, å°±å¯ä»¥çœ‹åˆ°é¡¹ç›®ä¸­æ‰€æœ‰çš„æ¥å£äº†, ä¸äº†è§£è¿™ä¸ªåŠŸèƒ½çš„è¯, è¿™é‡Œå·²ç»ç»™å¤§å®¶å‡†å¤‡å¥½äº† ; [ä¼ é€é—¨](https://www.cnblogs.com/syw20170419/p/8747675.html)

#### æ¥å£æ¦‚è§ˆ

![![5](C:\Users\AiTeZu\Desktop\5.jpg)](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/550b8ccc92324794bb4f1548f05575d0~tplv-k3u1fbpfcp-watermark.image)
![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9ff28428ce2a4adebb7215d59c328633~tplv-k3u1fbpfcp-watermark.image)


## é¡¹ç›®æè¿°

#### å‰è¨€ :

ä¸äº†è§£ä¸šåŠ¡ç›´æ¥çœ‹ä»£ç  , è¦ä¹ˆæ˜¯å¤§ç¥, è¦ä¹ˆæ˜¯æ¸£æ¸£ , æ‰€ä»¥æˆ‘è®¤ä¸ºè¿˜æ˜¯å¾ˆæœ‰å¿…è¦ä»‹ç»ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®çš„ ; 

è¿™ä¸ªé¡¹ç›®ä¹Ÿä¸ç®—æ˜¯æ‹è„‘è¢‹å°±æ¥äº†, ä½œè€…ä¹‹å‰åœ¨æŸé±¼ä¸Šä¹°äº†ä¸€å¥— `ui` è®¾è®¡å›¾ , é‡Œé¢çš„ä¸šåŠ¡åœºæ™¯, éƒ½æ˜¯æ ¹æ®è®¾è®¡å›¾æƒ³å‡ºæ¥çš„, å½“ç„¶ä¼šæœ‰å¥½å¤šä¸åˆç†çš„åœ°æ–¹, ç”šè‡³æœ‰ä¸€äº›åŠŸèƒ½æ ¹æœ¬æ²¡æœ‰å®ç°å‡ºæ¥, å…·ä½“åŸå› æˆ‘å°±ä¸è¯´äº† ; `psd` æ”¾åˆ°æ–‡ç« æœ«å°¾äº†, åç»­æˆ‘è¿™è¾¹ä¼šæŠŠå‰ç«¯ç»™åšå‡ºæ¥; å½“ç„¶å•¦å¦‚æœä½ ä»¬æœ‰å…´è¶£ä¹Ÿå¯ä»¥è‡ªå·±åšåšçœ‹ ; å¦‚æœæ¶‰åŠåˆ°ç‰ˆæƒå¯ä»¥è”ç³»æˆ‘åˆ é™¤ ;

#### ä¸šåŠ¡ : 

é¡¹ç›®æ˜¯ä¸€ä¸ªå…¼èŒ app åº”ç”¨ , ç›®å‰å®ç°çš„æ¨¡å—æœ‰, å®å…¸ , é—¨ä»»åŠ¡ , ç”¨æˆ·åé¦ˆ , å®ä¹  , å…¼èŒ , ç”¨æˆ· , å…¶ä¸­ä¸ªäººè®¤ä¸ºå®ä¹ å’Œå…¼èŒçš„ä¸šåŠ¡è€¦åˆç¨‹åº¦æ¯”è¾ƒé«˜, æ‰€ä»¥å°±ç»Ÿä¸€å¤„ç†äº† , ä¸šåŠ¡åœºæ™¯ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•, æ¯”è¾ƒé€‚åˆåšç»ƒæ‰‹é¡¹ç›®, ç”±äºä½“é‡ä¸å¤§, ä¹Ÿå¯ä»¥ä½œä¸ºæ–°æŠ€æœ¯å­¦ä¹ ä½¿ç”¨ ; 

#### é¡¹ç›®ç›®å½• :

```
â”œâ”€bin                      é¡¹ç›®å¯åŠ¨æ–‡ä»¶
â”œâ”€config                   é¡¹ç›®é…ç½®æ–‡ä»¶(postmanæ¥å£æ–‡æ¡£, æ•°æ®åº“é…ç½®ç­‰ç­‰)
â”œâ”€controller               æ¨¡å—æ§åˆ¶å™¨(å¤„ç†è¿”å›å†…å®¹, ä¸»è¦çš„å‚æ•°æ ¡éªŒ)
â”œâ”€lib
â”‚  â”œâ”€db.js                 æ•°æ®åº“äºŒæ¬¡å°è£…
â”‚  â”œâ”€helper.js             æ•°æ®è¿”å›ç»Ÿä¸€å¤„ç†
â”‚  â”œâ”€utils.js              å·¥å…·å‡½æ•°
â”‚  â”œâ”€validator.js          å‚æ•°æ ¡éªŒç»Ÿä¸€ç®¡ç†
â”œâ”€middlewares              ä¸­é—´ä»¶(æ­¤é¡¹ç›®ä¸­åªæ˜¯åšäº† auth)
â”œâ”€models                   æ•°æ®è¡¨æ¨¡å‹
â”œâ”€public                   é™æ€æ–‡ä»¶, æ¯”å¦‚ä¸Šä¼ çš„æ–‡ä»¶
â”‚  â””â”€images
â”œâ”€routes                   è·¯ç”±ç»Ÿä¸€ç®¡ç†
â”œâ”€services                 å…·ä½“æ¥å£é€»è¾‘çš„å¤„ç†
â”œâ”€views
â”œâ”€app.js                   é¡¹ç›®å…¥å£æ–‡ä»¶
â””â”€package.json             npmä¾èµ–æ–‡ä»¶
```

#### ç»†èŠ‚å¤„ç† :

- è¿”å›æ•°æ®å¤„ç†

```bash
/lib/helper.js
```

```javascript
class JSONResolve {
  success(msg = "success", code = 200) {
    return {
      msg,
      code,
    };
  }

  json(data, msg = "success", code = 200) {
    return {
      msg,
      code,
      data,
    };
  }
}

module.exports = new JSONResolve();
```

é€šè¿‡è°ƒç”¨ `success` æˆ–è€… `json` æ–¹æ³•è¿”å›å¯æ§çš„æˆåŠŸæ•°æ® ; å¯¹äºä¸å¯æ§çš„æ•°æ®è¿”å›ç”¨é”™è¯¯å¤„ç†ä¸­é—´ä»¶å¤„ç† ; 

```bash
/app.js
```

```javascript
app.use(
  jsonError({
    // é»˜è®¤ä¼šæŠŠå †æ ˆä¿¡æ¯ä¹Ÿç»™ä¸€èµ·å‘ç»™å®¢æˆ·ç«¯, è¿™æ ·å¾ˆæ˜æ˜¾æ˜¯ä¸åˆç†çš„æ‰€ä»¥åšäº†ä¸€å±‚ç®€å•çš„å¤„ç†
    postFormat(e, { stack, ...rest }) {
      const customRet = {
        msg: rest.message,
        code: rest.status,
      };
      return process.env.NODE_ENV === "production"
        ? customRet
        : { stack, ...rest, e };
    },
  })
);
```

å¦‚æœéœ€è¦æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸, åˆ™å¯ä»¥ä½¿ç”¨ `ctx.throw(500, 'æœåŠ¡å™¨å¤„ç†é”™è¯¯');` ç±»ä¼¼äºè¿™æ ·çš„æ ¼å¼æŠ›å‡ºè‡ªå®šä¹‰çš„é”™è¯¯ ; 

- è·¯ç”±ç»Ÿä¸€æ³¨å†Œ

```bash
/router/index.js
```

```javascript
const fs = require("fs");
const path = require("path");

module.exports = {
  routing(app) {
    const files = fs.readdirSync(__dirname);
    files.forEach((item) => {
      if (item === "index.js") return;
      const route = require(path.resolve(__dirname, item));
      app.use(route.routes()).use(route.allowedMethods());
    });
  },
};
```

åœ¨ `index.js` ä¸­é€šè¿‡ `fs` `path` æ¨¡å—è¯»å–å…¶ä»–è·¯ç”±ç»Ÿä¸€æ³¨å†Œ (å…¶ä»–æ–‡ä»¶ä¸è¦å¿˜è®°å¯¼å‡º `router`), ç„¶åæ”¾åˆ° `app.js` ä¸­ç»Ÿä¸€æ³¨å†Œ ; 

## è®¾è®¡å›¾çš„éƒ¨åˆ†å±•ç¤º

> è¿˜æ˜¯é‚£å¥è¯, ä½œè€…ä¹‹å‰åœ¨æŸé±¼ä¹°çš„ , `psd` æˆ‘æ”¾åˆ°æ–‡ç« æœ«å°¾äº†, å¦‚æœæ¶‰åŠåˆ°ç‰ˆæƒå¯ä»¥è”ç³»æˆ‘åˆ é™¤ ; 
>
> å¤§å®¶å¦‚æœæ ¹æ®è¿™ä¸ªåç«¯åšå‰ç«¯é¡¹ç›®çš„æ—¶å€™, å»ºè®®ä¹Ÿç•™ä¸‹æ˜æ˜¾çš„æµ‹è¯•è®°å·, åç»­æœ‰ç©ºçš„è¯, æˆ‘ä¹Ÿä¼šæ¨å‡º `vue` æˆ–è€… `react` ç‰ˆæœ¬çš„å‰ç«¯é¡¹ç›® ;

![![](C:\Users\AiTeZu\Desktop\1.jpg)](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c103051a2ca041b287ebbcf7924cb5f5~tplv-k3u1fbpfcp-watermark.image)
![![2](C:\Users\AiTeZu\Desktop\2.jpg)](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3b2a45be208b4449984a9c4fac5c87be~tplv-k3u1fbpfcp-watermark.image)
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/14c86c67959d4b89a9e1989bf12d52d4~tplv-k3u1fbpfcp-watermark.image)
![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/814ac7702f824b10911331c4703cb194~tplv-k3u1fbpfcp-watermark.image)

## æœ€å

è‡ªå·±å†™é¡¹ç›®å¯ä»¥è¯´è€æ—©å°±æƒ³äº† , ä½œè€…å‰ç«¯æ˜¯è‡ªå­¦çš„, å¾ˆèœ ; ä¹‹å‰çœ‹è§†é¢‘çš„æ—¶å€™ , éƒ½æ˜¯è·Ÿç€è§†é¢‘èµ°, æœ‰ç‚¹è‡ªå·±çš„æƒ³æ³•å¾—ä¸åˆ°å®è·µ, è¯´æ˜¯é¡¹ç›®å®æˆ˜è§†é¢‘, å¯¹æˆ‘æ¥è¯´æ›´åƒæ˜¯**é¡¹ç›®æŠ„å†™**, æ‰€ä»¥ä¸€ç›´éƒ½æƒ³è‡ªå·±åšä¸€ä¸ªé¡¹ç›® ; ç°åœ¨çš„æƒ³æ³•ä¹Ÿå¾ˆç®€å•, å°±æ˜¯åé¢å¯ä»¥ç”¨è‡ªå·±å­¦åˆ°çš„å‰ç«¯æŠ€æœ¯å»åšé¡¹ç›®, ä¸å†å®³æ€•æ²¡æœ‰æ¥å£, æ²¡æœ‰è®¾è®¡å›¾ç­‰ç­‰**å€Ÿå£**, æœ€åé€ æˆäº†æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯ä¼šè¯­æ³•, ç„¶åé•¿æœŸå¾—ä¸åˆ°ç»ƒä¹ , æœ€åå¿˜è®°ğŸ˜‚ ;

æŠŠé¡¹ç›®æ”¾å‡ºæ¥ä¹Ÿæ˜¯å¸Œæœ›åƒæˆ‘è¿™æ ·çš„äºº, éƒ½èƒ½å¾—åˆ°ä¸€äº›æˆé•¿, å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©è¿˜å¸Œæœ› [ç‚¹ä¸ªå°æ˜Ÿæ˜Ÿ](https://github.com/ShuQingX/part-time) 

[è®¾è®¡å›¾ä¼ é€é—¨](https://pan.baidu.com/s/1__Minss6OsGA791gXnN1kw)  æå–ç ï¼ša9yo 